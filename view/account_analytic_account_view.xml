<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
        <!--
	 <record id="contracts_by_type_filter" model="ir.ui.view">
            <field name="name">account_analytic_account.filter</field>
            <field name="model">account.analytic.account</field>
            <field name="inherit_id" ref="account_analytic_analysis.view_account_analytic_account_overdue_search"/>
            <field name="arch" type="xml">
                <filter string="Status" position="after">
                        <filter string="Contract Type" domain="[]" context="{'group_by':'contract_type'}"/>
                </filter>
            </field>
        </record>
        -->

        <!--
        <record model="ir.ui.view" id="account_analytic_account_remove_Invoice_Price_Rate_per_User">
            <field name="name">account.analytic.account.remove.Invoice.Price.Rate.per.User</field>
            <field name="model">account.analytic.account</field>
            <field name="inherit_id" ref="analytic_user_function.view_account_analytic_account_form_inherit"/>
            <field name="arch" type="xml">
                <xpath expr="(//div[@name='user_function_price'])" position="attributes">
                    <attribute name='invisible'>1</attribute> 
                </xpath>
            </field>
        </record>
        -->

        <record model="ir.ui.view" id="sale_subscription_contract_improvements">
            <field name="name">account.analytic.account.invoicing</field>
            <field name="model">sale.subscription</field>
            <field name="inherit_id" ref="sale_contract.sale_subscription_view_form"/>
            <field name="arch" type="xml">
                <!-- Status bar -->
                <field name="state" position="attributes">
                    <attribute name="statusbar_visible">negociation,open,pending,close,cancelled,refused</attribute>
                    <attribute name="readonly">0</attribute>
                    <attribute name="clickable">True</attribute>
                </field>

                <!-- Whole new page to manage AbAKUS BL contracts -->
                <xpath expr="//group[@name='main']" position="after">
                    <group>
                       <!-- Support Contract Info -->
                        <group string="Contract Settings" id="contract_settings" attrs="{'invisible': [('type','=','template')]}">
                            <field name="contract_type"/>
                            <field name="contractual_minimum_amount"/>
                            <field name="contract_type_product_name"/>
                            <field name="timesheet_product_price"/>
                            <field name="contract_team"/>
                        </group>
                        <!-- Invoicing and status -->
                        <group string="Invoicing Support Contract" id="invoicing_support_contract">
                            <field name="quantity_max" />
                            <div attrs="{'invisible': [('computed_units_consumed','=',0)]}" class="oe_grey">
                                <field name="computed_units_consumed" class="oe_inline"/> Units Consumed
                            </div>
                            <div attrs="{'invisible': [('computed_units_remaining','=',0)]}" class="oe_grey">
                                <field name="computed_units_remaining" class="oe_inline"/> Units Remaining
                            </div>
                            <field name="number_of_timesheets"/>
                            <field name="total_invoice_amount" invisible="1"/>
                            <field name="total_invoice_amount_info"/>
                            <button name="create_invoice" type="object" string="Create invoice" class="oe_highlight" attrs="{'invisible':[('total_invoice_amount','&gt;=',0)]}"/>
                        </group>
                    </group>
                </xpath>
            </field>
        </record>
    </data>
</openerp>
